(function(){$(document).ready(function(){let bg=chrome.extension.getBackgroundPage();function b(c){c="http://atelier801.com/"+c;chrome.tabs.create({url:c})}function a(c){if(c.hasError==true){$(".application").addClass("hiddenElement");$(".errorMessage").removeClass("hiddenElement")}else{$(".application").removeClass("hiddenElement");$(".errorMessage").addClass("hiddenElement");$(".newActivity").empty();var d=c.forumActivity;for(index in d){$(".newActivity").append("<li postUrl='"+d[index]["postUrl"]+"' lastPostUser='"+d[index]["lastPostUser"]+"'><span>"+d[index]["postTitle"]+" by "+d[index]["lastPostUser"]+"</span></li>")}}}chrome.runtime.onMessage.addListener(function(e,d,c){a(e.tfm_notify_data)});bg.getData(function(c){if($.isEmptyObject(c)){bg.saveData(userData)}else{let elementNotFound=true;$("select option").each(function(){if(Number($(this).val())==Number(c.tfm_notify_data.refreshTime)){$(this).attr("selected",true);elementNotFound=false}});if(elementNotFound){$("select option:last").attr("selected",true)}a(c.tfm_notify_data)}});$("#refreshTime").on("change",function(){let refreshTime=$("select option:selected").val();bg.userData.tfm_notify_data.refreshTime=refreshTime;bg.saveData(bg.userData)});$(".alreadySaw").click(function(){chrome.browserAction.setBadgeText({text:""});window.close()});$(".goToForum").click(function(){b("")});$(".refresh").click(function(){bg.checkFavorites()});$(".settingsIcon").click(function(){$(".sideBar").addClass("sideBarShow")});$(".closeConfig").click(function(){$(".sideBar").removeClass("sideBarShow")});$(document).on("click",".newActivity li",function(){bg.updateNotification(""+($(".newActivity li").length-1),false);let lastUser=$(this).attr("lastPostUser"),postUrl=$(this).attr("postUrl");bg.getData(function(c){let activityData=c.tfm_notify_data.forumActivity;for(let x=0,activityLength=activityData.length;x<activityLength;x++){if(activityData[x].postUrl==postUrl&&activityData[x].lastPostUser==lastUser){activityData.splice(x,1);c.tfm_notify_data.forumActivity=activityData;bg.saveData(c)}}});$(this).remove();b($(this).attr("postUrl"))})})})();